/**
 * @author zhixin wen <wenzhixin2010@gmail.com>
 * @version 1.2.1
 * @license MIT
 *
 * https://github.com/wenzhixin/multiple-select
 *
 * SteamDB: This file has been modified to work with the sales page.
 */(function(i){"use strict";var a=function(e){var s=arguments,t=!0,o=1;return e=e.replace(/%s/g,function(){var n=s[o++];return typeof n>"u"?(t=!1,""):n}),t?e:""};function c(e,s){var t=this,o=e.attr("name")||s.name||"";this.options=s,this.$el=e.hide(),this.$parent=i(a('<div class="ms-parent %s" %s/>',e.attr("class")||"",a('title="%s"',e.attr("title")))),this.$choice=i(a(['<button class="ms-choice" type="button">','<span class="placeholder">%s</span>',"</button>"].join(""),this.options.placeholder)),this.$drop=i('<div class="ms-drop"></div>'),this.$el.after(this.$parent),this.$parent.append(this.$choice),this.$parent.append(this.$drop),this.$el.prop("disabled")&&this.$choice.addClass("disabled"),this.selectItemNameRaw="selectItem"+o,this.selectItemName='data-name="'+this.selectItemNameRaw+'"',this.options.keepOpen||i(document.body).on("click",function(n){n.target===t.$choice[0]||i(n.target).parents(".ms-choice")[0]===t.$choice[0]||(n.target===t.$drop[0]||i(n.target).parents(".ms-drop")[0]!==t.$drop[0]&&n.target!==e[0])&&t.options.isOpen&&t.close()})}c.prototype={constructor:c,init:function(){var e=this,s=i("<ul></ul>");this.$drop.html(""),this.options.filter&&this.$drop.append(['<div class="ms-search">','<input type="text" autocomplete="off" autocorrect="off" autocapitilize="off" spellcheck="false" placeholder="Search">',"</div>"].join("")),i.each(this.$el.children(),function(t,o){s.append(e.optionToHtml(o))}),s.append(a('<li class="ms-no-results">%s</li>',this.options.noMatchesFound)),this.$drop.append(s),this.$searchInput=this.$drop.find(".ms-search input"),this.$selectItems=this.$drop.find("input["+this.selectItemName+"]:enabled"),this.$disableItems=this.$drop.find("input["+this.selectItemName+"]:disabled"),this.$noResults=this.$drop.find(".ms-no-results"),this.events(),this.update(),this.options.isOpen&&this.open()},optionToHtml:function(e){const s=i(e),t=document.createElement("span");t.append(...e.childNodes);const o=document.createElement("input");o.type=this.options.single?"radio":"checkbox",o.value=e.getAttribute("value"),o.dataset.name=this.selectItemNameRaw,(s.prop("selected")||s.data("selected"))&&(o.checked=!0);const n=document.createElement("label");n.append(o),n.append(t);const l=document.createElement("li");return l.append(n),l},events:function(){var e=this,s=function(t){t.preventDefault(),e[e.options.isOpen?"close":"open"]()};this.$choice.off("click").on("click",s),this.$parent.off("keydown").on("keydown",function(t){switch(t.which){case 27:e.close(),e.$choice.focus();break}}),this.$searchInput.off("keydown").on("keydown",function(t){t.keyCode===9&&t.shiftKey&&e.close()}).off("keyup").off("input").on("input",function(t){e.filter()}),this.$selectItems.off("click").on("click",function(){if(e.options.onClick(this),e.options.single&&e.options.isOpen&&!e.options.keepOpen&&e.close(),e.options.single){var t=i(this).val();e.$selectItems.filter(function(){return i(this).val()!==t}).each(function(){i(this).prop("checked",!1)})}e.update()})},open:function(){this.$choice.hasClass("disabled")||(this.options.isOpen=!0,this.$drop.show(),this.$noResults.hide(),this.options.filter&&(this.$searchInput.val(""),this.$searchInput.focus(),this.filter()))},close:function(){this.options.isOpen=!1,this.$drop.hide()},update:function(){var e=this.getSelects("text"),s=this.$choice.find(">span"),t=e.length;t===0?s.addClass("placeholder").html(this.options.placeholder):this.options.countSelected&&t>this.options.minimumCountSelected?s.removeClass("placeholder").html(this.options.countSelected.replace("#",e.length).replace("%",this.$selectItems.length+this.$disableItems.length)):s.removeClass("placeholder").html(e.join(this.options.delimiter)),this.$el.val(this.getSelects()),this.$drop.find("li").removeClass("selected"),this.$drop.find("input:checked").each(function(){i(this).parents("li").first().addClass("selected")})},getSelects:function(e){var s=this,t=[],o=[];return this.$drop.find(a("input[%s]:checked",this.selectItemName)).each(function(){t.push(i(this).parents("li").find("span").html()),o.push(i(this).val())}),e==="text"?t:o},filter:function(){var e=this,s=i.trim(this.$searchInput.val()).toLowerCase();s.length===0?(this.$selectItems.parent().show(),this.$disableItems.parent().show(),this.$noResults.hide()):(this.$selectItems.each(function(){var t=i(this).parent();t[t.text().toLowerCase().indexOf(s)<0?"hide":"show"]()}),this.$disableItems.parent().hide(),this.$selectItems.parent().filter(":visible").length?this.$noResults.hide():this.$noResults.show())}},i.fn.multipleSelect=function(){var e=arguments[0],s=arguments,t,o=["getSelects"];return this.each(function(){var n=i(this),l=n.data("multipleSelect"),h=i.extend({},i.fn.multipleSelect.defaults,n.data(),typeof e=="object"&&e);if(l||(l=new c(n,h),n.data("multipleSelect",l)),typeof e=="string"){if(i.inArray(e,o)<0)throw new Error("Unknown method: "+e);t=l[e](s[1])}else l.init(),s[1]&&(t=l[s[1]].apply(l,[].slice.call(s,2)))}),typeof t<"u"?t:this},i.fn.multipleSelect.defaults={name:"",isOpen:!1,placeholder:"",minimumCountSelected:3,single:!1,filter:!1,keepOpen:!1,delimiter:", ",countSelected:"# of % selected",noMatchesFound:"No matches found",onClick:function(){return!1}}})(jQuery);
